library(ccsviewr)

test_that("noEndGap", {
  # Test verifies that the alignment proceeds with no gaps in front or back.
  ref  = "TCTGCAGAAATGGGCGTTCTGGCCCTCGCGAGGCAGTGCGACCTGTCACCGCCCTTCAGCCTTCCCGCCCTCCACCAAGCCCGCGCACGCCCGGCCCGCGCGTCTGTCTTTCGACCCGGCACCCCGGCCGGTTCCCAGCAGCGCGCATGCGCGCGCTCCCAGGCCACTTGAAGAGAGAGGGCGGGGCCGAGGGGCTGAGCCCGCGGGGGGAGGGAACAGCGTTGATCACGTGACGTGGTTTCAGTGTTTACACCCGCAGCGGGCCGGGGGTTCGGCCTCAGTCAGGCGCTCAGCTCCGTTTCGGTTTCACTTCCGGTGGAGGGCCGCCTCTGAGCGGGCGGCGGGCCGACGGCGAGCGCGGGCGGCGGCGGTGACGGAGGCGCCGCTGCCAGGGGGCGTGCGGCAGCGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGAGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCTGGGCCTCGAGCGCCCGCAGCCCACCTCTCGGGGGCGGGCTCCCGGCGCTAGCAGGGCTGAAGAGAAGATGGAGGAGCTGGTGGTGGAAGTGCGGGGCTCCAATGGCGCTTTCTACAAGGTACTTGGCTCTAGGGCAGGCCCCATCTTCGCCCTTCCTTCCCTCCCTTTTCTTCTTGGTGTCGGCGGGAGGCAGGCCCGGGGCCCTCTTCCCGAGCACCGCGCCTGGGTGCCAGGGCACGCTCGGCGGGATGTTGTTGGGAGGGAAGGACTGGACTTGGGGCCTGTTGGAAGCCCCTCTCCGACTCCGAGAGGCCCTAGCGCCTATCGAAATGAGAGACCAGCGAGGAGAGGGTTCTCTTTCGGCGCCGAGCCCCGCCGGGGTGAGCTGGGGATGGGCGAGGGCCGGCGGCAGGTACTAGA"
  query = "TCAGGCGCTCAGCTCCGTTTCGGTTTCA"
  result = ccsviewr::AlignRefAndRead(ref, list(name="query", read = query), TRUE)
  result$read
  testthat::expect_true(grepl(query, result$read))
})
